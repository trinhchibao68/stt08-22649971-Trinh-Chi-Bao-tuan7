<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="22656091_Doan Thi Thao_Tuan07" content="Javascript">
    <title>Dang ky</title>
    <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
            crossorigin="anonymous"
        />
    <link rel="stylesheet" href="../css/main.css">
    <script src="../js/jquery.js"></script>
</head>
<body>
    <div class="container-fluid">
        <div class="title_form">
            <p class="text-center text-primary">Register Form</p>
        </div>
        <form action="">
            <table class="table table-bordered">
                <tr>
                    <td><label for="" class="form-label">Họ và tên(*):</label></td>
                    <td style="display: flex;">
                        <input type="text" class="form-control input__hoTen">
                        <span style="color: red; margin: 0px 10px;"></span>
                    </td>
                </tr>
                <tr>
                    <td><label for="" class="form-label label__name-login">Tên đăng nhập(*):</label></td>
                    <td style="display: flex;"><input type="text" class="form-control input__name-login">
                        <span style="color: red; margin: 0px 10px;"></span>
                    </td>
                </tr>
                <tr>
                    <td><label for="" class="form-label">Mât khẩu(*):</label></td>
                    <td style="display: flex;"><input type="text" class="form-control input__matKhau">
                        <span style="color: red; margin: 0px 10px;"></span>
                    </td>
                </tr>
                <tr>
                    <td><label for="" class="form-label">Xác nhận mật khẩu(*):</label></td>
                    <td style="display: flex;"><input type="text" class="form-control input__xacNhanMk">
                        <span style="color: red; margin: 0px 10px;"></span>
                    </td>
                </tr>
                <tr>
                    <td><label for="" class="form-label">Ngày sinh:</label></td>
                    <td>
                        <select name="ngaySinh" id="ngaySinh">
                            
                        </select>
                        <label for="thangSinh" class="form-label">Tháng:</label>
                        <select name="thangSinh" id="thangSinh"></select>
                        <label for="" class="form-label">Năm:</label>
                        <select name="namSinh" id="namSinh"></select>
                    </td>
                </tr>
                <tr>
                    <td><label for="" class="form-label">Số điện thoại:</label></td>
                    <td style="display: flex;"><input type="text" class="form-control input__sdt">
                        <span style="color: red; margin: 0px 10px;"></span>
                    </td>
                </tr>
                <tr>
                    <td><label for="" class="form-label">Địa chỉ:</label></td>
                    <td style="display: flex;"><input type="text" class="form-control input__diaChi">
                        <span style="color: red; margin: 0px 10px;"></span>
                    </td>
                </tr>
                <tr>
                    <td><label for="" class="form-label">Email khác:</label></td>
                    <td style="display: flex;"><input type="text" class="form-control input__email">
                        <span style="color: red; margin: 0px 10px;"></span>
                    </td>
                </tr>
                <tr>
                    <td><label for="" class="form-label">Sở thích:</label></td>
                    <td>
                        <select name="soThich" id="soThich">
                            <option value="1">Ca nhạc</option>
                            <option value="2">Nhảy</option>
                            <option value="3">Múa</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td><label for="" class="form-label"></label></td>
                    <td>
                        <button type="button" class="btn btn-sm btn__dangky">Đăng Ký</button>
                        <button type="button" class="btn btn-sm btn__huy">Hủy</button>
                    </td>
                </tr>
            </table>
        </form>
    </div>
    <script>
        $(document).ready(function() {
            let inputNgaySinh = $('#ngaySinh')
            let inputThangSinh = $('#thangSinh')
            let inputNamSinh = $('#namSinh')
            console.log(inputNgaySinh)
            for(let i=1; i<=31; i++) {
                let option = document.createElement('option')
                option.value = i
                option.text = i
                inputNgaySinh.append(option)
            }
            for(let i=1; i<=12; i++) {
                let option = document.createElement('option')
                option.value = i
                option.text = i
                inputThangSinh.append(option)
            }
            let year = new Date()
            for(let i=2000; i<=year.getFullYear(); i++) {
                let option = document.createElement('option')
                option.value = i
                option.text = i
                inputNamSinh.append(option)
            }

            let hoten = $('.input__hoTen')
            let tenDangNhap = $('.input__name-login')
            let matKhau = $('.input__matKhau')
            let xacNhanMatKhau = $('.input__xacNhanMk')
            let ngaySinh = $('#ngaySinh')
            let thangSinh = $('#thangSinh')
            let namSinh = $('#namSinh')
            let sdt = $('.input__sdt')
            let diaChi = $('.input__diaChi')
            let email = $('.input__email')
            let soThich = $('#soThich')
            let btnDangKy = $('.btn__dangky')
            let btnHuy = $('.btn__huy')

            btnHuy.click(function() {
                hoten.val('')
                tenDangNhap.val('')
                matKhau.val('')
                xacNhanMatKhau.val('')
                ngaySinh.val(1)
                thangSinh.val(1)
                namSinh.val(2000)
                sdt.val('')
                diaChi.val('')
                email.val('')
                soThich.val(1)
            })

            function check() {
                let regexHoten = /([A-Z][a-z]+\s){1,2}([A-Z][a-z]+)/
                let regexTenDangNhap = /[a-zA-Z0-9!@#$%^&*()_+\s]{6,}/
                let regexMatKhau = /[a-zA-Z0-9!@#$%^&*()_+]+/
                let regexSDT = /[0-9]{3,10}/
                let regexDiaChi = /[a-zA-Z0-9\/]+/
                let regexEmail = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/
                if(!regexHoten.test(hoten.val().trim())) {
                    hoten.focus()
                    hoten.addClass('is-invalid')
                    hoten.next('span').text('tên không phù hợp')
                    return false
                }
                else {
                    hoten.removeClass('is-invalid')
                    $('.input__hoTen').next('span').text('')
                }
                if(!regexTenDangNhap.test(tenDangNhap.val().trim())) {
                    tenDangNhap.focus()
                    tenDangNhap.addClass('is-invalid')
                    tenDangNhap.next('span').text('tên đăng nhập phải dài hơn 6 kí tự')
                    return false
                }
                else {
                    tenDangNhap.removeClass('is-invalid')
                    tenDangNhap.next('span').text('')
                }
                if(!regexMatKhau.test(matKhau.val().trim())) {
                    matKhau.focus()
                    matKhau.addClass('is-invalid')
                    matKhau.next('span').text('mật khẩu không phù hợp')
                    return false
                }
                else {
                    matKhau.removeClass('is-invalid')
                    matKhau.next('span').text('')
                }
                if(xacNhanMatKhau.val().trim() !=  matKhau.val().trim()) {
                    xacNhanMatKhau.focus()
                    xacNhanMatKhau.addClass('is-invalid')
                    xacNhanMatKhau.next('span').text('mật khẩu không khớp')
                    return false
                }
                else {
                    xacNhanMatKhau.removeClass('is-invalid')
                    xacNhanMatKhau.next('span').text('')
                }
                if(!regexSDT.test(sdt.val().trim())) {
                    sdt.focus()
                    sdt.addClass('is-invalid')
                    sdt.next('span').text('số điện thoại phải dài từ 3 - 10 kí tự số')
                    return false
                }
                else {
                    sdt.removeClass('is-invalid')
                    sdt.next('span').text('')
                }
                if(!regexDiaChi.test(diaChi.val().trim())) {
                    diaChi.focus()
                    diaChi.addClass('is-invalid')
                    diaChi.next('span').text('địa chỉ không phù hợp')
                    return false
                }
                else {
                    diaChi.removeClass('is-invalid')
                    diaChi.next('span').text('')
                }
                if(!regexEmail.test(email.val().trim())) {
                    email.focus()
                    email.addClass('is-invalid')
                    email.next('span').text("email không hợp lệ")
                    return false
                }
                else {
                    email.removeClass('is-invalid')
                    email.next('span').text('')
                }
                return true
            }

            btnDangKy.click(function() {
                if(!check()) return
                let obj = {
                    hoten : hoten.val().trim(),
                    tenDangNhap : tenDangNhap.val().trim(),
                    matKhau : matKhau.val().trim(),
                    xacNhanMatKhau : xacNhanMatKhau.val().trim(),
                    ngaySinh : `${ngaySinh.val()}/${thangSinh.val()}/${namSinh.val()}`,
                    sdt : sdt.val().trim(),
                    email : email.val().trim(),
                    soThich : soThich.val().trim(),
                    diaChi : diaChi.val().trim()
                }
                localStorage.setItem('infor',JSON.stringify(obj))
                window.location.href = 'thongtin.html'
            })
        })
    </script>
    
</body>
</html>

